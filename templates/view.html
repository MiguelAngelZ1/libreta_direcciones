{% extends "base.html" %}

{% block title %}Ver Registros - Mi Aplicaci√≥n{% endblock %}

{% block content %}
  <h2>Registros en la Libreta</h2>
  
  <!-- Campo de b√∫squeda y bot√≥n para limpiar filtros -->
  <input type="text" id="searchBox" placeholder="Buscar por nombre, apellido o DNI">
  <button onclick="limpiarBusqueda()">üßπ Limpiar B√∫squeda</button>

  {% if registros %}
    <table id="contactTable">
      <thead>
        <tr>
          <th>Grado</th>
          <th>Nombre</th>
          <th>Apellido</th>
          <th>DNI</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody id="tableBody">
        {% for registro in registros %}
          <tr data-nombre="{{ registro.nombre | lower }}"
              data-apellido="{{ registro.apellido | lower }}"
              data-dni="{{ registro.dni }}">
            <td>{{ registro.grado }}</td>
            <td>{{ registro.nombre }}</td>
            <td>{{ registro.apellido }}</td>
            <td>{{ registro.dni }}</td>
            <td>
              <!-- Botones de acci√≥n usando data attributes -->
              <button class="btn-editar"
                      data-id="{{ registro.id }}"
                      data-grado="{{ registro.grado }}"
                      data-nombre="{{ registro.nombre }}"
                      data-apellido="{{ registro.apellido }}"
                      data-dni="{{ registro.dni }}">
                ‚úèÔ∏è Editar
              </button>
              <!-- Modal para edici√≥n -->
<div id="editModal" class="modal" style="display: none;">
  <div class="modal-content">
      <h2>Editar Contacto</h2>
      <form id="editForm" method="POST" action="/edit">
          <input type="hidden" id="editId" name="id">
          <label>Grado:</label>
          <input type="text" id="editGrado" name="grado">
          <label>Nombre:</label>
          <input type="text" id="editNombre" name="nombre">
          <label>Apellido:</label>
          <input type="text" id="editApellido" name="apellido" pattern="[A-Za-z\s]+" title="El apellido solo debe contener letras">
          <label>DNI:</label>
          <input type="text" id="editDni" name="dni">
          <div class="modal-buttons">
              <button type="button" onclick="cerrarModal()">Cancelar</button>
              <button type="submit">Confirmar cambios</button>
          </div>
      </form>
  </div>
</div>

              <button class="btn-eliminar" data-id="{{ registro.id }}">
                ‚ùå Eliminar
              </button>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>No hay registros disponibles.</p>
  {% endif %}
{% endblock %}
