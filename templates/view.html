{% extends "base.html" %}

{% block title %}
  Ver Registros
{% endblock %}

{% block content %}
  <h2>Registros en la Libreta</h2>
  
  <input type="text" id="searchBox" placeholder="Buscar por nombre, apellido o DNI">
  <button onclick="limpiarBusqueda()">üßπ Limpiar B√∫squeda</button>

  {% if registros %}
    <table id="contactTable">
      <thead>
        <tr>
          <th>ID</th>
          <th>Grado</th>
          <th>Nombre</th>
          <th>Apellido</th>
          <th>DNI</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody id="tableBody">
        {% for registro in registros %}
          <tr data-nombre="{{ registro[2].lower() }}" data-apellido="{{ registro[3].lower() }}" data-dni="{{ registro[4] }}">
            <td>{{ registro[0] }}</td>
            <td>{{ registro[1] }}</td>
            <td>{{ registro[2] }}</td>
            <td>{{ registro[3] }}</td>
            <td>{{ registro[4] }}</td>
            <td>
              <button onclick="abrirModal('{{ registro[0] }}', '{{ registro[1] }}', '{{ registro[2] }}', '{{ registro[3] }}', '{{ registro[4] }}')">‚úèÔ∏è Editar</button>
              <button onclick="eliminarContacto('{{ registro[0] }}')">‚ùå Eliminar</button>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>No hay registros disponibles.</p>
  {% endif %}

  <!-- Modal para edici√≥n -->
  <div id="editModal" class="modal" style="display: none;">
    <div class="modal-content">
      <h2>Editar Contacto</h2>
      <form id="editForm" method="POST" action="/edit">
        <input type="hidden" id="editId" name="id">
        <label>Grado:</label>
        <input type="text" id="editGrado" name="grado">
        <label>Nombre:</label>
        <input type="text" id="editNombre" name="nombre">
        <label>Apellido:</label>
        <input type="text" id="editApellido" name="apellido" pattern="[A-Za-z\s]+" title="El apellido solo debe contener letras">
        <label>DNI:</label>
        <input type="text" id="editDni" name="dni">
        <div class="modal-buttons">
          <button type="button" onclick="cerrarModal()">Cancelar</button>
          <button type="button" onclick="confirmarEdicion()">Confirmar cambios</button>
        </div>
      </form>
    </div>
  </div>
{% endblock %}
